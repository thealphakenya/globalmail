<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GlobalMail - Sign In</title>
    <link rel="stylesheet" href="style.css"> <!-- Corrected the path to style.css -->
    <script defer src="js/auth.js"></script> <!-- Corrected path to auth.js in the js folder -->
</head>
<body>
    <header>
        <h1>Welcome to GlobalMail</h1>
    </header>

    <main>
        <div id="sign-in-form">
            <h2>Sign In</h2>
            <form id="signInForm">
                <input type="email" id="email" placeholder="Email" required>
                <input type="password" id="password" placeholder="Password" required>
                <button type="submit">Login</button>
            </form>
            <p><a href="forgot-password.html">Forgot Password?</a></p>
            <p>Don't have an account? <a href="register.html">Create one</a></p>
        </div>
    </main>

    <script>
        async function signIn(event) {
            event.preventDefault(); // Prevent form submission

            let email = document.getElementById("email").value;
            let password = document.getElementById("password").value;

            if (!email || !password) {
                alert("Please fill in all fields.");
                return;
            }

            // Here, we check if the user is an admin or a regular user
            if (email === "rovicviccy@gmail.com" && password === "Victor9798!") {
                // Admin login logic
                localStorage.setItem("admin", JSON.stringify({ email: "rovicviccy@gmail.com" }));
                alert("Admin Login Successful!");
                window.location.href = "adminHomepage.html"; // Redirect to admin homepage
            } else {
                // Regular user login logic (mocked)
                let users = JSON.parse(localStorage.getItem("users")) || []; // Get users from localStorage
                let user = users.find(u => u.email === email && u.password === password);

                if (user) {
                    localStorage.setItem("user", JSON.stringify(user)); // Store user in localStorage
                    alert("Login Successful!");
                    window.location.href = "globalmailhomepage.html"; // Redirect to homepage if logged in
                } else {
                    alert("Invalid Credentials or User Not Found.");
                }
            }
        }

        // Automatically redirect if user is already logged in
        window.onload = () => {
            const user = localStorage.getItem("user");
            const admin = localStorage.getItem("admin");

            if (user) {
                window.location.href = "globalmailhomepage.html"; // Redirect to homepage if regular user
            } else if (admin) {
                window.location.href = "adminHomepage.html"; // Redirect to admin homepage if admin
            }
        };

        // Attach the signIn function to the form submission event
        document.getElementById("signInForm").addEventListener("submit", signIn);
    </script>
</body>
</html>
